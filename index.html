<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Vitamin by vitaminjs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Vitamin</h1>
      <h2 class="project-tagline">ActiveRecord library for node.js applications</h2>
      <a href="https://github.com/vitaminjs/vitamin" class="btn">View on GitHub</a>
      <a href="https://github.com/vitaminjs/vitamin/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/vitaminjs/vitamin/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h3>

<p>Vitamin provides a simple and easy to use ActiveRecord implementation for working with your database. It supports <strong>Postgres</strong>, <strong>MySQL</strong>, <strong>MariaDB</strong>, <strong>SQLite3</strong>, and <strong>Oracle</strong>.</p>

<p>Each database table or view is wrapped into a "Model" class. Thus, a model instance is tied to a single row in the table. Models allow you to query for data in your tables, as well as inserting or updating records.</p>

<p>Vitamin is featuring both promise based and traditional callback interfaces, providing lazy and eager relationships loading, and support for one-to-one, one-to-many, and many-to-many relations.</p>

<hr>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h3>

<div class="highlight highlight-source-shell"><pre>$ npm install --save vitamin

<span class="pl-c"># Then add one of the following (adding a --save) flag:</span>
$ npm install pg
$ npm install sqlite3
$ npm install mysql
$ npm install mysql2
$ npm install mariasql
$ npm install strong-oracle
$ npm install oracle</pre></div>

<p>Database connection is initialized by passing a config object to <code>connection</code> static method. The <a href="//knexjs.org/#Installation">knex documentation</a> provides a number of examples for different databases.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Model <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>vitamin/model<span class="pl-pds">'</span></span>)

<span class="pl-c">// provide a config object for MySQL which will be used by knex</span>
<span class="pl-smi">Model</span>.<span class="pl-en">connection</span>({
  client<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>mysql<span class="pl-pds">'</span></span>,
  connection<span class="pl-k">:</span> {
    host     <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>127.0.0.1<span class="pl-pds">'</span></span>,
    user     <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>your_database_user<span class="pl-pds">'</span></span>,
    password <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>your_database_password<span class="pl-pds">'</span></span>,
    database <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>myapp_test<span class="pl-pds">'</span></span>,
    charset  <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>utf8<span class="pl-pds">'</span></span>
  }
})</pre></div>

<hr>

<h3>
<a id="defining-models" class="anchor" href="#defining-models" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Defining Models</h3>

<p>To get started, let's define a basic Model using the <code>extend</code> static method, and specify both, the <code>primary key</code> name, and the <code>table</code> name</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Model <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>vitamin/model<span class="pl-pds">'</span></span>)

<span class="pl-k">var</span> Post <span class="pl-k">=</span> <span class="pl-smi">Model</span>.<span class="pl-en">extend</span>({

  <span class="pl-c">/**</span>
<span class="pl-c">   * The table name associated with this model</span>
<span class="pl-c">   */</span>
  $table<span class="pl-k">:</span>  <span class="pl-s"><span class="pl-pds">"</span>posts<span class="pl-pds">"</span></span>,

  <span class="pl-c">/**</span>
<span class="pl-c">   * The primary key name, by default 'id' is used</span>
<span class="pl-c">   */</span>
  $pk<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>,

})</pre></div>

<blockquote>
<p>Vitamin assumes that the primary key is an auto-increment key, if you wish to use a non-numeric key, you must set to <code>false</code> the flag property <code>$incrementing</code> when you define the model.</p>
</blockquote>

<hr>

<h3>
<a id="retrieving-models" class="anchor" href="#retrieving-models" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Retrieving models</h3>

<p>Vitamin uses the standard Node.js style callbacks and promises when dealing with queries</p>

<h4>
<a id="-retrieving-multiple-models" class="anchor" href="#-retrieving-multiple-models" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>· Retrieving multiple models</h4>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Using callbacks</span>
<span class="pl-smi">Post</span>.<span class="pl-c1">all</span>(<span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">result</span>) {
  <span class="pl-k">...</span>
})

<span class="pl-c">// Using promises</span>
<span class="pl-smi">Post</span>.<span class="pl-c1">all</span>().<span class="pl-en">then</span>(
  <span class="pl-k">function</span> (<span class="pl-smi">result</span>) {
    <span class="pl-k">...</span>
  },
  <span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
    <span class="pl-k">...</span>
  }
)</pre></div>

<p>The <code>all</code> static method will return all of the results of the model. But, if you may also add constraints to queries, you can use the <code>where</code> method, which returns a <code>query builder</code> instance</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Using callabcks</span>
<span class="pl-smi">Post</span>.<span class="pl-en">where</span>(<span class="pl-s"><span class="pl-pds">'</span>active<span class="pl-pds">'</span></span>, <span class="pl-c1">true</span>).<span class="pl-en">limit</span>(<span class="pl-c1">10</span>).<span class="pl-en">fetchAll</span>(<span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">result</span>) {
  <span class="pl-k">...</span>
})

<span class="pl-c">// Using promises</span>
<span class="pl-smi">Post</span>.<span class="pl-en">where</span>(<span class="pl-s"><span class="pl-pds">'</span>active<span class="pl-pds">'</span></span>, <span class="pl-c1">true</span>).<span class="pl-en">limit</span>(<span class="pl-c1">10</span>).<span class="pl-en">fetchAll</span>().<span class="pl-en">then</span>(
  <span class="pl-k">function</span> (<span class="pl-smi">result</span>) {
    <span class="pl-k">...</span>
  },
  <span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
    <span class="pl-k">...</span>
  }
)</pre></div>

<h4>
<a id="-retrieving-single-model" class="anchor" href="#-retrieving-single-model" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>· Retrieving single model</h4>

<p>Of course, in addition to retrieving all of the records for a given table, you may also retrieve single records using <code>find</code> and <code>fetch</code>. Instead of returning an array of models, these methods return only a single model instance</p>

<p>To retrieve a model by its primary key, use <code>find</code></p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Using callbacks</span>
<span class="pl-smi">Post</span>.<span class="pl-c1">find</span>(<span class="pl-c1">1</span>, <span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">result</span>) {
  <span class="pl-k">...</span>
})

<span class="pl-c">// Using promises</span>
<span class="pl-smi">Post</span>.<span class="pl-c1">find</span>(<span class="pl-c1">1</span>).<span class="pl-en">then</span>(
  <span class="pl-k">function</span> (<span class="pl-smi">result</span>) {
    <span class="pl-k">...</span>
  },
  <span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
    <span class="pl-k">...</span>
  }
)</pre></div>

<p>To retrieve the first model matching the query constraints, use <code>fetch</code></p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Using callbacks</span>
<span class="pl-smi">Post</span>.<span class="pl-en">where</span>(<span class="pl-s"><span class="pl-pds">'</span>published<span class="pl-pds">'</span></span>, <span class="pl-c1">1</span>).<span class="pl-en">fetch</span>(<span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">result</span>) {
  <span class="pl-k">...</span>
})

<span class="pl-c">// Using promises</span>
<span class="pl-smi">Post</span>.<span class="pl-en">where</span>(<span class="pl-s"><span class="pl-pds">'</span>published<span class="pl-pds">'</span></span>, <span class="pl-c1">1</span>).<span class="pl-en">fetch</span>().<span class="pl-en">then</span>(
  <span class="pl-k">function</span> (<span class="pl-smi">result</span>) {
    <span class="pl-k">...</span>
  },
  <span class="pl-k">function</span> (<span class="pl-smi">error</span>) {
    <span class="pl-k">...</span>
  }
)</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/vitaminjs/vitamin">Vitamin</a> is maintained by <a href="https://github.com/vitaminjs">vitaminjs</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
